<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Dynamic triangulation | BurstTriangulator </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Dynamic triangulation | BurstTriangulator ">
    
    
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.svg" alt="BurstTriangulator">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search" style="
                display: flex;
                flex-direction: row-reverse;
                justify-content: space-between;
                align-items: center;">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
                <!-- Added by me -->
                <div style="margin-right: 15px;"><a href="https://github.com/andywiecko/BurstTriangulator/"><i class="fa fa-github" style="font-size:30px; color: white"></i></a></div>
              </form>
            </div>
          </div>
        </nav>        <div class="subnav navbar navbar-default">
            <div class="container" style="
                display: flex;
                flex-direction: row-reverse;
                justify-content: space-between;
                align-items: center;
            ">
                <div class="container hide-when-search" id="breadcrumb">
                 <ul class="breadcrumb">
                   <li></li>
                 </ul>
                </div>
                <div class="container" style="
                    width: 80px;
                    line-height: 40px;
                "><b>v3.8.0</b></div>
          </div>
        </div>      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="dynamic-triangulation-manual">
<h1 id="dynamic-triangulation">Dynamic triangulation</h1>

<p>Using the <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.UnsafeTriangulator-1.html"><code>UnsafeTriangulator&lt;T&gt;</code></a> API, you can perform dynamic triangulation.
This feature is especially useful in scenarios like path-finding in RTS games, where recalculating only a small portion of the mesh, instead of the entire mesh, can significantly improve efficiency.</p>
<h2 id="dynamicinsertpoint">DynamicInsertPoint</h2>
<p>The <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicInsertPoint.html">DynamicInsertPoint</a> method allows you to insert a point into a specified triangle using barycentric coordinates. This method only supports point insertion within the original triangulation domain and cannot be used to insert points outside the existing mesh.</p>
<p>Inserting a point at specific <code>T2 p</code> coordinates can be computationally expensive since it requires locating the triangle that contains the point <code>p</code>.
This package does not include acceleration structures, as it assumes the user will implement this based on their specific requirements.
It is recommended to use structures such as bounding volume hierarchies, 2D trees, grids, or buckets for efficient point lookup (<code>p</code> <span class="math">\(\to \triangle\)</span>).
The most suitable acceleration structure may vary depending on the use case.</p>
<p>The <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicInsertPoint.html">DynamicInsertPoint</a> method accepts the following parameters (in addition to <code>output</code> and <code>allocator</code>):</p>
<ul>
<li><code>tId</code> the index of the triangle where the point should be inserted.</li>
<li><code>bar</code> the barycentric coordinates of the point inside triangle <code>tId</code>.</li>
</ul>
<div class="IMPORTANT">
<h5>Important</h5>
<p>All <span class="math">\(\texttt{bar}\)</span> coordinates must be valid barycentric coordinates <em>inside</em> the triangle, meaning</p>
<ul>
<li><span class="math">\(\forall_i\,\,\texttt{bar}[i]\in(0, 1)\)</span>;</li>
<li><span class="math">\(\sum_i \, \texttt{bar}[i] = 1\)</span>.</li>
</ul>
</div>
<p>Here is an example of how to use the API:</p>
<pre><code class="lang-csharp">var t = new UnsafeTriangulator&lt;float2&gt;();

using var positions = new NativeArray&lt;float2&gt;(..., Allocator.Persistent);
using var constraints = new NativeArray&lt;int&gt;(..., Allocator.Persistent);
var input = new NativeInputData&lt;float2&gt;
{
    Positions = positions,
    ConstraintEdges = constraints
};

using var outputPositions = new NativeList&lt;float2&gt;(Allocator.Persistent);
using var triangles = new NativeList&lt;int&gt;(Allocator.Persistent);
using var halfedges = new NativeList&lt;int&gt;(Allocator.Persistent);
using var constrainedHalfedges = new NativeList&lt;bool&gt;(Allocator.Persistent);
var output = new NativeOutputData&lt;float2&gt;
{
    Positions = outputPositions,
    Triangles = triangles,
    Halfedges = halfedges,
    ConstrainedHalfedges = constrainedHalfedges
};

t.Triangulate(input, output, args: Args.Default(autoHolesAndBoundary: true), Allocator.Persistent);

// Insert a new point in triangle with index 42 at the center (barycentric coordinates: [⅓, ⅓, ⅓]).
t.DynamicInsertPoint(output, tId: 42, bar: 1f / 3, allocator: Allocator.Persistent);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>To quickly calculate the corresponding <code>bar</code> for a given <code>p</code> inside a triangle <code>(a, b, c)</code>, you can use the following utility function (not included in the package):</p>
<pre><code class="lang-csharp">static float3 Bar(float2 p, float2 a, float2 b, float2 c)
{
  float cross(float2 x, float2 y) =&gt; x.x * y.y - x.y * y.x;
  var (v0, v1, v2) = (b - a, c - a, p - a);
  var v = cross(v2, v1) / cross(v0, v1);
  var w = cross(v0, v2) / cross(v0, v1);
  var u = 1 - v - w;
  return math.float3(u, v, w);
}
</code></pre>
</div>
<h2 id="dynamicsplithalfedge">DynamicSplitHalfedge</h2>
<p>The <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicSplitHalfedge.html">DynamicSplitHalfedge</a> method allows you to split specified halfedge by inserting a point at a position determined by linear interpolation.
The position is interpolated between the start and end points of the halfedge in the triangulation using <span class="math">\(\alpha\)</span> as the interpolation parameter.
This method preserves the &quot;constrained&quot; state of the halfedge, meaning that if the specified halfedge is constrained, the two resulting sub-segments will also be marked as constrained.</p>
<p>The <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicSplitHalfedge.html">DynamicSplitHalfedge</a> method accepts the following parameters (in addition to <code>output</code> and <code>allocator</code>):</p>
<ul>
<li><code>he</code> the index of the halfedge to split.</li>
<li><code>alpha</code> the interpolation parameter for positioning the new point between the start and end points of the halfedge, where <span class="math">\(p = (1 - \alpha) \, \text{start} + \alpha \, \text{end}\)</span>.</li>
</ul>
<p>Here is an example of how to use the API:</p>
<pre><code class="lang-csharp">var t = new UnsafeTriangulator&lt;float2&gt;();

using var positions = new NativeArray&lt;float2&gt;(..., Allocator.Persistent);
using var constraints = new NativeArray&lt;int&gt;(..., Allocator.Persistent);
var input = new NativeInputData&lt;float2&gt;
{
    Positions = positions,
    ConstraintEdges = constraints
};

using var outputPositions = new NativeList&lt;float2&gt;(Allocator.Persistent);
using var triangles = new NativeList&lt;int&gt;(Allocator.Persistent);
using var halfedges = new NativeList&lt;int&gt;(Allocator.Persistent);
using var constrainedHalfedges = new NativeList&lt;bool&gt;(Allocator.Persistent);
var output = new NativeOutputData&lt;float2&gt;
{
    Positions = outputPositions,
    Triangles = triangles,
    Halfedges = halfedges,
    ConstrainedHalfedges = constrainedHalfedges
};

t.Triangulate(input, output, args: Args.Default(autoHolesAndBoundary: true), Allocator.Persistent);

// Iteratively split random halfedges.
var random = new Unity.Mathematics.Random(seed: 42);
for(int i = 0; i &lt; 32; i++)
{
    t.DynamicInsertPoint(output, he: random.NextInt(0, triangles.Length), alpha: 0.5f, allocator: Allocator.Persistent);
}
</code></pre>
<h2 id="dynamicremovebulkpoint">DynamicRemoveBulkPoint</h2>
<p>The <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicRemoveBulkPoint.html">DynamicRemoveBulkPoint</a> method allows you to remove bulk points, i.e. points which are not boundary ones, and re-triangulates the affected region to maintain a valid triangulation.
In addition to <code>output</code> and <code>allocator</code>, the method requires the index of the point to be removed, specified as <code>pId</code>.</p>
<p>Below is an example demonstrating how to use the <a class="xref" href="../../api/andywiecko.BurstTriangulator.LowLevel.Unsafe.Extensions.DynamicRemoveBulkPoint.html">DynamicRemoveBulkPoint</a> API:</p>
<pre><code class="lang-csharp">using var inputPositions = new NativeArray&lt;double2&gt;(..., Allocator.Persistent);
using var outputPositions = new NativeList&lt;double2&gt;(Allocator.Persistent);
using var triangles = new NativeList&lt;int&gt;(Allocator.Persistent);
using var constrainedHalfedges = new NativeList&lt;bool&gt;(Allocator.Persistent);
using var halfedges = new NativeList&lt;int&gt;(Allocator.Persistent);

var t = new UnsafeTriangulator&lt;double2&gt;();
var input = new NativeInputData&lt;double2&gt; { Positions = inputPositions };
var output = new NativeOutputData&lt;double2&gt;
{
    Positions = outputPositions,
    Triangles = triangles,
    ConstrainedHalfedges = constrainedHalfedges,
    Halfedges = halfedges,
};

t.Triangulate(input, output, args: Args.Default(), allocator: Allocator.Persistent);
t.DynamicRemoveBulkPoint(output, pId: 8, allocator: Allocator.Persistent);
</code></pre>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      Generated by <strong>DocFX</strong> | Documentation © 2024 by <a href="https://github.com/andywiecko">Andrzej Więckowski</a> is licensed under CC BY 4.0
      
          </div>
        </div>
      </footer>
    </div>
    <!-- https://github.com/dotnet/docfx/tree/main/templates/default/partials -->
    <!-- https://github.com/dotnet/docfx/tree/main/templates/statictoc/partials -->
    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
    .hljs {
        background: #f5f5f5;
    }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>
</html>
